<!DOCTYPE html>
<html>
<head>
  <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
  <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>  
  <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
  <style>
                    .ar-video{width:100%;height:100vh}
                    .btn-container{    /* text-align: center; */ position: absolute; bottom: -25px; margin: 0 auto; background: rgba(255, 255, 255, 0.45098039215686275);padding: 10px; width: 100%; text-align: -webkit-center;}
                    .btn{display: block; background-color: #784e98; text-decoration: none; color: #fff;cursor: pointer;  box-shadow: 0px -2px 10px #000;   padding: 10px;   border-radius: 10px;width:100px;}                    
                </style>
</head>
<body style='margin : 0px; overflow: hidden;'>
   <video class="ar-video" id="video" width="640" height="480" autoplay></video>            
   <canvas id="canvas" width="640" height="480" style="display:none"></canvas>
  
    <a-scene embedded artoolkit='sourceType:webcam;'>

      <a-marker preset="hiro">    

      <a-entity>
        <a-entity id="drone" position="0 0 -0.5" scale="0.5 0.5 0.5" rotation="-90 -45 45"
          gltf-model-next="src: url(./assets/marcus/scene.gltf);"
          animation-mixer>
        </a-entity>
        <a-animation attribute="alternate"                   
                     fill="backwards"
                     to="0 0 0.5"
                     repeat="indefinite"
                     direction="alternateReverse"
                     begin="1000"
                     dur="10000">        
        </a-animation>
        </a-entity>
      </a-marker>        
    </a-scene>  
     <div class='btn-container'>            
            <a class='btn' id="download">Snap/Download</a>
            </div>
</body>
   <script>
            // Grab elements, create settings, etc.
            var video = document.getElementById('video');

            // Elements for taking the snapshot
            var canvas = document.getElementById('canvas');
            var context = canvas.getContext('2d');
            var video = document.getElementById('video');
        
     
        document.getElementById('download').addEventListener('click', function() {
        context.drawImage(video, 0, 0, 640, 480);
        downloadCanvas(this, 'canvas', new Date().toJSON()+".png");
        }, false);
                
            // Get access to the camera!
            if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                // Not adding `{ audio: true }` since we only want video now
                navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
                    video.src = window.URL.createObjectURL(stream);
                    video.play();
                });
            }
            function downloadCanvas(link, canvasId, filename) {
                    link.href = document.getElementById(canvasId).toDataURL();
                    link.download = filename;
                }
         
        </script>
</html>

